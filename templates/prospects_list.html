{% extends "base.html" %}

{% block title %}Prospects - CRM Tool{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Prospects</h1>
    <a href="/prospects/new" class="btn btn-primary">+ New Prospect</a>
</div>

{% if prospects %}
<table class="data-table">
    <thead>
        <tr>
            <th>Name</th>
            <th>Company</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Stage</th>
            <th>Estimated Revenue</th>
            <th>Next Follow-Up</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for prospect in prospects %}
        <tr>
            <td>{{ prospect.name }}</td>
            <td>{{ prospect.company or '-' }}</td>
            <td>{{ prospect.email or '-' }}</td>
            <td>{{ prospect.phone or '-' }}</td>
            <td><span class="status-badge status-{{ prospect.stage.lower().replace(' ', '-') }}">{{ prospect.stage }}</span></td>
            <td>
                <!-- IMPROVEMENT 4: Only show revenue if it exists -->
                {% if prospect.estimated_revenue %}
                    ${{ "{:,.2f}".format(prospect.estimated_revenue) }}
                {% else %}
                    <span class="text-muted">Not specified</span>
                {% endif %}
            </td>
            <td>{{ prospect.next_follow_up.strftime('%Y-%m-%d') if prospect.next_follow_up else '-' }}</td>
            <td>
                <a href="/prospects/{{ prospect.id }}" class="btn btn-sm btn-secondary">View</a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div class="empty-state">
    <p>No prospects found.</p>
    <a href="/prospects/new" class="btn btn-primary">Create Your First Prospect</a>
</div>
{% endif %}
{% endblock %}

